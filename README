# Jira Assistant MCP Server

An MCP (Model Context Protocol) server for managing Jira tickets. Designed for rapid iteration while preventing duplicate work between engineers.

## Setup

### 1. Install dependencies

```powershell
poetry install
```

### 2. Configure environment

Create a `.env` file in the project root:

```
JIRA_HOST=https://your-domain.atlassian.net
JIRA_EMAIL=your-email@example.com
JIRA_API_TOKEN=your-api-token-here
PROJECT_KEYS=PROJ1,PROJ2
DEFAULT_PRIORITY=Medium
DEFAULT_ISSUE_TYPE=Task
ACTIONABLE_STATUS=To Do
```

**Environment Variables:**
- `JIRA_HOST` (required): Your Jira instance URL
- `JIRA_EMAIL` (required): Your Jira account email
- `JIRA_API_TOKEN` (required): Your Jira API token
- `PROJECT_KEYS` (required for defaults): Comma-separated list of project keys. The first project becomes the default for `create_new_ticket`.
- `DEFAULT_PRIORITY` (optional): Default priority for new tickets (default: "Medium")
- `DEFAULT_ISSUE_TYPE` (optional): Default issue type for new tickets (default: "Task")
- `DEFAULT_SPRINT` (optional): Default sprint ID for new tickets (numeric)
- `SPRINT_FIELD` (optional): Custom field name for sprints (default: "customfield_10020")
- `ACTIONABLE_STATUS` (optional): Status that indicates a ticket is ready for pickup (default: "To Do")

To get your API token:
1. Go to https://id.atlassian.com/manage-profile/security/api-tokens
2. Click "Create API token"
3. Copy the token and paste it in your `.env` file

### 3. Configure your MCP client

Add to your MCP client config (Claude Desktop: `%APPDATA%\Claude\claude_desktop_config.json`, Cursor: `~/.cursor/mcp.json`).

**Option A: Using virtualenv Python directly (recommended)**

First, find your virtualenv path:

```powershell
poetry env info --path
```

Then add to your config (use forward slashes):

```json
{
  "mcpServers": {
    "jira-assistant": {
      "command": "C:/Users/YourUsername/AppData/Local/pypoetry/Cache/virtualenvs/jira-assistant-XXXXXX-py3.XX/Scripts/python.exe",
      "args": ["-m", "jira_assistant.server"]
    }
  }
}
```

**Option B: Using poetry with cwd**

```json
{
  "mcpServers": {
    "jira-assistant": {
      "command": "poetry",
      "args": ["run", "jira-assistant"],
      "cwd": "C:/Users/YourUsername/path/to/jira-assistant"
    }
  }
}
```

See `mcp.example.json` for a template.

## Available Tools

### Read Operations

#### `get_assigned_tickets`
Get all Jira tickets assigned to you.

**Parameters:**
- `max_results` (optional): Maximum number of tickets to return (default: 50)
- `status` (optional): Filter by status (e.g., "In Progress", "To Do")
- `project` (optional): Filter by project key (e.g., "PROJ")
- `exclude_done` (optional): Exclude completed tickets (default: true)

#### `get_available_tickets`
Get unassigned tickets that are ready to be picked up.

**Parameters:**
- `max_results` (optional): Maximum number of tickets to return (default: 50)
- `status` (optional): Override the actionable status filter
- `project` (optional): Filter by project key

#### `get_available_epics`
Get open epics that can be used to link new work.

**Parameters:**
- `max_results` (optional): Maximum number of epics to return (default: 50)
- `project` (optional): Filter by project key

#### `get_epic_tickets`
Get all tickets/stories that belong to a specific epic. Results are grouped by status.

**Parameters:**
- `epic_key` (required): The epic key (e.g., "PROJ-100")
- `max_results` (optional): Maximum number of tickets to return (default: 50)
- `include_done` (optional): Include completed tickets (default: true)

#### `get_ticket_details`
Get detailed information about a specific ticket including description and comments.

**Parameters:**
- `ticket_key` (required): The Jira ticket key (e.g., "PROJ-123")

#### `search_similar_tickets`
Search for tickets with similar text to find potential duplicates or related work.

**Parameters:**
- `search_text` (required): Text to search for in ticket summaries and descriptions
- `max_results` (optional): Maximum number of results (default: 10)
- `include_done` (optional): Include completed tickets in search (default: false)
- `project` (optional): Filter by project key for faster searches

### Write Operations

#### `create_new_ticket`
Create a new Jira ticket using default settings. Only requires a summary - uses defaults from environment for project, priority, and issue type.

**Parameters:**
- `summary` (required): Ticket title/summary
- `description` (optional): Detailed description of the ticket
- `epic_key` (optional): Epic key to link this ticket to

**Uses defaults from .env:**
- Project: First project in `PROJECT_KEYS`
- Priority: `DEFAULT_PRIORITY`
- Issue type: `DEFAULT_ISSUE_TYPE`
- Sprint: `DEFAULT_SPRINT` (if set)

#### `create_new_epic`
Create a new Jira epic. Automatically checks for similar existing epics and warns if potential duplicates are found.

**Parameters:**
- `project` (required): Project key (e.g., "PROJ")
- `summary` (required): Epic title/summary
- `description` (optional): Detailed description of the epic

#### `update_ticket_details`
Update fields on an existing Jira ticket. Only provided fields will be updated. Can also transition the ticket to a new status.

**Parameters:**
- `ticket_key` (required): The Jira ticket key (e.g., "PROJ-123")
- `summary` (optional): New ticket title/summary
- `description` (optional): New description
- `status` (optional): Transition to a new status (e.g., "In Progress", "Done")
- `assignee` (optional): Assignee account ID or email
- `priority` (optional): Priority (e.g., "Highest", "High", "Medium", "Low", "Lowest")
- `labels` (optional): Array of labels (replaces existing labels)
- `sprint` (optional): Sprint ID (numeric) to move the ticket to
- `epic_key` (optional): Epic key to link this ticket to

#### `add_ticket_comment`
Add a comment to a Jira ticket.

**Parameters:**
- `ticket_key` (required): The Jira ticket key (e.g., "PROJ-123")
- `comment` (required): The comment text to add

## Development

Verify your configuration loads correctly:

```powershell
poetry run python -c "from jira_assistant.tools import ALL_TOOLS; print(f'{len(ALL_TOOLS)} tools loaded')"
```

Run the server directly for testing:

```powershell
poetry run python -m jira_assistant.server
```

Note: The server uses stdio for communication, so it will produce no output when run directly. This is expected behavior.

## Project Structure

```
jira_assistant/
├── __init__.py
├── config.py          # Environment variables and auth helpers
├── server.py          # MCP server orchestration
└── tools/
    ├── __init__.py
    ├── get_assigned_tickets.py
    ├── get_available_tickets.py
    ├── get_available_epics.py
    ├── get_epic_tickets.py
    ├── get_ticket_details.py
    ├── search_similar_tickets.py
    ├── create_new_ticket.py
    ├── create_new_epic.py
    ├── update_ticket_details.py
    ├── add_ticket_comment.py
    └── transition_ticket.py    # Internal helper (used by update_ticket_details)
```
